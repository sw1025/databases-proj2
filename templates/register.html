<!DOCTYPE html>
<html>
<head>
    <title>Register</title>
</head>
<body>

<h2>Create an Account</h2>

<!-- ABSOLUTE PATH ensures POST works even if HTML is loaded directly -->
<form action="/registerAuth" method="POST">

    <label>Register as:</label>
    <select name="register_type" id="register_type" onchange="showFields()" required>
        <option value="customer">Customer</option>
        <option value="agent">Booking Agent</option>
        <option value="staff">Airline Staff</option>
    </select>
    <br><br>

    <label>Email / Username:</label>
    <input type="text" name="username" required>
    <br><br>

    <label>Password:</label>
    <input type="password" name="password" required>
    <br><br>

    <!-- CUSTOMER FIELDS -->
    <div id="customer_fields">
        <label>Name:</label>
        <input type="text" name="name"><br><br>

        <label>Building #:</label>
        <input type="text" name="buildingnum"><br><br>

        <label>Street:</label>
        <input type="text" name="street"><br><br>

        <label>City:</label>
        <input type="text" name="city"><br><br>

        <label>State:</label>
        <input type="text" name="state"><br><br>

        <label>Phone Number:</label>
        <input type="text" name="tel"><br><br>

        <label>Passport Number:</label>
        <input type="text" name="passportid"><br><br>

        <label>Passport Expiration:</label>
        <input type="date" name="passportexp"><br><br>

        <label>Passport Country:</label>
        <input type="text" name="country"><br><br>

        <label>Date of Birth:</label>
        <input type="date" name="dob"><br><br>
    </div>

    <!-- STAFF FIELDS -->
    <div id="staff_fields" style="display:none;">
        <label>First Name:</label>
        <input type="text" name="first_name"><br><br>

        <label>Last Name:</label>
        <input type="text" name="last_name"><br><br>

        <label>Date of Birth:</label>
        <input type="date" name="dob"><br><br>

        <label>Airline Name:</label>
        <input type="text" name="airline_name"><br><br>

        <label>Role:</label>
        <select name="role">
            <option value="admin">Admin</option>
            <option value="staff">Staff</option>
            <option value="both">Both</option>
        </select>
        <br><br>
    </div>

    <button type="submit">Register</button>
</form>

{% if error %}
<p style="color:red;">{{ error }}</p>
{% endif %}

<script>
function showFields() {
    const type = document.getElementById("register_type").value;
    document.getElementById("customer_fields").style.display =
        type === "customer" ? "block" : "none";
    document.getElementById("staff_fields").style.display =
        type === "staff" ? "block" : "none";
}

// Safety redirect if user loads register.html directly
if (window.location.pathname.endsWith("register.html")) {
    window.location.href = "/register";
}
</script>

</body>
</html>
